<div class="add-delivery-man-container">
  <div class="header">
    <h2>Add Delivery Man</h2>
  </div>

  <form [formGroup]="addForm" (ngSubmit)="onSubmit()" class="delivery-form" autocomplete="off">
    <div class="form-group">
      <label for="name">Name</label>
      <input id="name" formControlName="name" placeholder="Name" [class.invalid]="addForm.get('name')?.invalid && addForm.get('name')?.touched" />
      <div class="error" *ngIf="addForm.get('name')?.invalid && addForm.get('name')?.touched">
        Name is required (3-50 chars).
      </div>
    </div>

    <div class="form-group">
      <label for="email">Email</label>
      <input id="email" formControlName="email" type="email" placeholder="Email" [class.invalid]="addForm.get('email')?.invalid && addForm.get('email')?.touched" />
      <div class="error" *ngIf="addForm.get('email')?.invalid && addForm.get('email')?.touched">
        Valid email is required.
      </div>
    </div>

    <div class="form-group">
      <label for="userName">Username</label>
      <input id="userName" formControlName="userName" placeholder="Username" [class.invalid]="addForm.get('userName')?.invalid && addForm.get('userName')?.touched" />
      <div class="error" *ngIf="addForm.get('userName')?.invalid && addForm.get('userName')?.touched">
        Username is required (4-30 chars).
      </div>
    </div>

    <div class="form-group">
      <label for="password">Password</label>
      <input id="password" formControlName="password" type="password" placeholder="Password" [class.invalid]="addForm.get('password')?.invalid && addForm.get('password')?.touched" />
      <div class="error" *ngIf="addForm.get('password')?.invalid && addForm.get('password')?.touched">
        Password must be at least 8 chars, include uppercase, lowercase, number, and symbol.
      </div>
    </div>

    <div class="form-group">
      <label for="phoneNumber">Phone Number</label>
      <input id="phoneNumber" formControlName="phoneNumber" placeholder="Phone Number" [class.invalid]="addForm.get('phoneNumber')?.invalid && addForm.get('phoneNumber')?.touched" />
      <div class="error" *ngIf="addForm.get('phoneNumber')?.invalid && addForm.get('phoneNumber')?.touched">
        Valid Egyptian phone number required.
      </div>
    </div>

    <div class="form-group">
      <label for="branchId">Branch</label>
      <select id="branchId" formControlName="branchId" [class.invalid]="addForm.get('branchId')?.invalid && addForm.get('branchId')?.touched">
        <option value="" disabled hidden>Select branch</option>
        <option *ngFor="let branch of branches" [value]="branch.id">{{ branch.name }}</option>
      </select>
      <div class="error" *ngIf="addForm.get('branchId')?.invalid && addForm.get('branchId')?.touched">
        Branch is required.
      </div>
    </div>

<div class="form-group">
      <label for="departmentId">Department</label>
      <select id="departmentId" formControlName="departmentId" [class.invalid]="addForm.get('departmentId')?.invalid && addForm.get('departmentId')?.touched">
        <option value="" disabled hidden>Select department</option>
        <option *ngFor="let department of departments" [value]="department.id">{{ department.name }}</option>
      </select>
      <div class="error" *ngIf="addForm.get('departmentId')?.invalid && addForm.get('departmentId')?.touched">
        Department is required.
      </div>
    </div>

    <div class="form-actions">
      <button class="add-btn" type="submit" [disabled]="addForm.invalid || isSubmitting">
        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <line x1="12" y1="5" x2="12" y2="19"/>
          <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
        Save
      </button>
    </div>

    <div *ngIf="errorMsg" class="error-msg">{{ errorMsg }}</div>
    <div *ngIf="successMsg" class="success-msg">{{ successMsg }}</div>
  </form>
</div>
